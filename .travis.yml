# Every commit to master leads to a new tagged release; a manual increment in the version number in
# package.json is needed before every git push to master for the Travis build to succeed.
# 
# To prevent a tagged release from being created and also to remove the need to increment the
# version number, use [skip travis] in the commit message.
language: generic
before_deploy:
  - git config --local user.name "rweigel"
  - git config --local user.email "rweigel@gmu.edu"
  - cd pkg && make update VERSION=`node -p "require('../package.json').version"`
  - export TRAVIS_TAG=`node -p "require('./package.json').version"`
  - git tag `node -p "require('../package.json').version"`

deploy:
  provider: releases
  api_key: $GITHUB_OAUTH_TOKEN
  file_glob: true
  file: dist/*
  skip_cleanup: true
